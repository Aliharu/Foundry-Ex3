<form class="{{cssClass}}" autocomplete="off">
    <header class="sheet-header">
        <img class="profile-img" src="{{item.img}}" data-edit="img" title="{{item.name}}" />
        <div class="header-fields">
            <h1 class="charname"><input name="name" type="text" value="{{item.name}}" placeholder="Name" /></h1>
            <div>
                <label class="resource-label">{{localize "Ex3.Ability"}}: </label>
                <select name="system.ability" data-type="String">
                    {{#select system.ability}}
                    {{#each charmAbilityListSectioned as |charmCategory charmCategoryType|}}
                    <optgroup label="{{localize charmCategory.label}}">
                        {{#each charmCategory.entries as |entry entryType|}}
                        <option value="{{entryType}}">{{localize entry}}</option>
                        {{/each}}
                    </optgroup>
                    {{/each}}
                    {{/select}}
                </select>
                <select name="system.requirement" data-type="String">
                    {{#select system.requirement}}
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    {{/select}}
                </select>
                <label class="resource-label">{{localize "Ex3.Essence"}}: </label>
                <select name="system.essence" data-type="String">
                    {{#select system.essence}}
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    {{/select}}
                </select>
            </div>
        </div>
    </header>

    <nav class="sheet-tabs tabs" data-group="primary">
        <a class="item" data-tab="description">{{localize "Ex3.Description"}}</a>
        <a class="item" data-tab="costs">{{localize "Ex3.Costs"}}</a>
        <a class="item" data-tab="bonuses">{{localize "Ex3.Dice"}}</a>
        <a class="item" data-tab="triggers">{{localize "Ex3.Triggers"}}</a>
        <a class="item" data-tab="macros">{{localize "Ex3.Macros"}}</a>
        <a class="item" data-tab="other">{{localize "Ex3.Other"}}</a>
    </nav>

    {{!-- Sheet Body --}}
    <section class="sheet-body">

        {{!-- Description Tab --}}
        <div class="tab" data-group="primary" data-tab="description">
            <div class="grid grid-2col flex-group-center">
                <div>
                    <div class="resource-label">{{localize "Ex3.Type"}}</div>
                    <input type="text" name="system.type" value="{{system.type}}" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.Duration"}}</div>
                    <input type="text" name="system.duration" value="{{system.duration}}" />
                </div>
            </div>
            <div class="flex-center mt-1">
                <div class="resource-label">{{localize "Ex3.Keywords"}} <a><i
                            class="fas fa-info-circle charms-cheat-sheet cursor-pointer"></i></a></div>
            </div>
            <input type="text" name="system.keywords" value="{{system.keywords}}" />
            <div class="flex-center mt-1">
                <div class="resource-label">{{localize "Ex3.CharmPrerequisites"}}</div>
            </div>
            <div class="embeded-item-list-wrapper" {{#if
                options.editable}}style="border: 1px solid var(--color-border-light-tertiary);" {{/if}}>
                <div class="flex-group-center embeded-item-list">
                    <ul>
                        {{#if options.editable}}
                        {{#each system.charmprerequisites as |item id|}}
                        <a draggable="true" class="embeded-item-pill" data-id="{{item.id}}"
                            data-item-name="{{item.name}}" data-item-index="{{id}}">
                            <li data-item-index="{{id}}">
                                {{item.name}}
                                <i class="fas fa-trash embeded-item-delete"></i>
                            </li>
                        </a>
                        {{/each}}
                        {{else}}
                        {{#each system.charmprerequisites as |item id|}}
                        <li class="embeded-item-pill" data-item-name="{{../name}}" data-item-index="{{id}}">
                            {{item.name}}
                        </li>
                        {{/each}}
                        {{/if}}
                    </ul>
                </div>
            </div>
            <div class="flex-center mt-1">
                <div class="resource-label">{{localize "Ex3.OtherPrerequisites"}}</div>
            </div>
            <input class="mb-1" type="text" name="system.prerequisites" value="{{system.prerequisites}}" />
            <div class="flex-center">
                <div class="resource-label">{{localize "Ex3.Description"}}</div>
            </div>
            {{editor descriptionHTML target="system.description" button=true editable=editable engine="prosemirror"}}
        </div>

        <div class="tab" data-group="primary" data-tab="costs">
            <div class="d-flex flex-center resources">
                <div>
                    <div class="resource-label">{{localize "Ex3.Motes"}}</div>
                    <input type="number" name="system.cost.motes" value="{{system.cost.motes}}" data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.CommitM"}}</div>
                    <input type="number" name="system.cost.commitmotes" value="{{system.cost.commitmotes}}"
                        data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.Initiative"}}</div>
                    <input type="number" name="system.cost.initiative" value="{{system.cost.initiative}}"
                        data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.Anima"}}</div>
                    <input type="number" name="system.cost.anima" value="{{system.cost.anima}}" data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.Willpower"}}</div>
                    <input type="number" name="system.cost.willpower" value="{{system.cost.willpower}}"
                        data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.GrappleControl"}}</div>
                    <input type="number" name="system.cost.grapplecontrol" value="{{system.cost.grapplecontrol}}"
                        data-dtype="Number" />
                </div>
            </div>
            <div class="grid grid-5col flex-group-center">
                <div>
                    <div class="resource-label">{{localize "Ex3.Health"}}</div>
                    <input type="number" name="system.cost.health" value="{{system.cost.health}}" data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.HealthType"}}</div>
                    <select name="system.cost.healthtype" data-type="String">
                        {{#select system.cost.healthtype}}
                        <option value="bashing">{{localize "Ex3.Bashing"}}</option>
                        <option value="lethal">{{localize "Ex3.Lethal"}}</option>
                        <option value="aggravated">{{localize "Ex3.Aggravated"}}</option>
                        {{/select}}
                    </select>
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.Aura"}}</div>
                    <select name="system.cost.aura" data-type="String">
                        {{#select system.cost.aura}}
                        <option value=""></option>
                        <option value="any">{{localize "Ex3.Any"}}</option>
                        <option value="air">{{localize "Ex3.Air"}}</option>
                        <option value="earth">{{localize "Ex3.Earth"}}</option>
                        <option value="fire">{{localize "Ex3.Fire"}}</option>
                        <option value="water">{{localize "Ex3.Water"}}</option>
                        <option value="wood">{{localize "Ex3.Wood"}}</option>
                        {{/select}}
                    </select>
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.XP"}}</div>
                    <input type="number" name="system.cost.xp" value="{{system.cost.xp}}" data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.Penumbra"}}</div>
                    <input type="number" name="system.cost.penumbra" value="{{system.cost.penumbra}}"
                        data-dtype="Number" />
                </div>
            </div>
            <div class="flex-center">
                <div class="resource-label">{{localize "Ex3.Craft"}} {{localize "Ex3.Cost"}}</div>
            </div>
            <div class="grid grid-3col flex-group-center">
                <div>
                    <div class="resource-label">{{localize "Ex3.Silver"}}</div>
                    <input type="number" name="system.cost.silverxp" value="{{system.cost.silverxp}}"
                        data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.Gold"}}</div>
                    <input type="number" name="system.cost.goldxp" value="{{system.cost.goldxp}}" data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.White"}}</div>
                    <input type="number" name="system.cost.whitexp" value="{{system.cost.whitexp}}"
                        data-dtype="Number" />
                </div>
            </div>
            <div class="flex-center">
                <div class="resource-label">{{localize "Ex3.Restore"}}</div>
            </div>
            <div class="grid grid-3col flex-group-center">
                <div>
                    <div class="resource-label">{{localize "Ex3.Motes"}}</div>
                    <input type="number" name="system.restore.motes" value="{{system.restore.motes}}"
                        data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.Willpower"}}</div>
                    <input type="number" name="system.restore.willpower" value="{{system.restore.willpower}}"
                        data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.Health"}}</div>
                    <input type="number" name="system.restore.health" value="{{system.restore.health}}"
                        data-dtype="Number" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.Initiative"}}</div>
                    <input type="number" name="system.restore.initiative" value="{{system.restore.initiative}}"
                        data-dtype="Number" />
                </div>
            </div>
        </div>

        <div class="tab" data-group="primary" data-tab="bonuses">
            <div class="resource flex-center mb-1" style="font-size: 17px;">
                <label class="resource-label">{{localize "Ex3.DiceRollModifiers"}} <a><i
                            class="formula-help fas fa-info-circle"></i></label></a></label>
            </div>
            <div class="d-flex flex-center resource-label">
                <div class="resource-label">{{localize "Ex3.DiceRollBonus"}}</div>
                <input name="system.diceroller.enabled" type="checkbox" {{checked system.diceroller.enabled}}>
            </div>
            <div>
                <div class="resource grid grid-3col flex-center">
                    <div>
                        <label class="resource-label"><a class="toggle-charm-dice"><i
                                    class="fa-solid fa-circle-check non-charm-dice" title="Toggle Non-Charm"></i></a>
                            {{localize "Ex3.DiceBonus"}}*</label>
                        <input name="system.diceroller.bonusdice" value="{{system.diceroller.bonusdice}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label"><a class="toggle-charm-successes"><i
                                    class="fa-solid fa-circle-check non-charm-successes"
                                    title="Toggle Non-Charm"></i></a> {{localize "Ex3.SuccessBonus"}}*</label>
                        <input name="system.diceroller.bonussuccesses" value="{{system.diceroller.bonussuccesses}}"
                            type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.DecreaseTargetNumber"}}</label>
                        <input name="system.diceroller.decreasetargetnumber"
                            value="{{system.diceroller.decreasetargetnumber}}" type="number">
                    </div>

                    <div>
                        <label class="resource-label">{{localize "Ex3.DoubleSuccess"}} +</label>
                        <input name="system.diceroller.doublesuccess" value="{{system.diceroller.doublesuccess}}"
                            type="number">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.RerollFailedDice"}}*</label>
                        <input name="system.diceroller.rerolldice" value="{{system.diceroller.rerolldice}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.DicetoSuccesses"}}*</label>
                        <input name="system.diceroller.diceToSuccesses" value="{{system.diceroller.diceToSuccesses}}"
                            type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.ReduceDifficulty"}}*</label>
                        <input name="system.diceroller.reducedifficulty" value="{{system.diceroller.reducedifficulty}}"
                            type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.RerollAllFailedOnce"}}</label>
                        <div>
                            <input type="checkbox" name="system.diceroller.rerollfailed"
                                value="system.diceroller.rerollfailed" {{checked system.diceroller.rerollfailed}}>
                        </div>
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.RollTwiceKeepHighest"}}</label>
                        <div>
                            <input type="checkbox" name="system.diceroller.rolltwice" {{checked
                                system.diceroller.rolltwice}}>
                        </div>
                    </div>
                </div>
            </div>

            <div class="resource flex-center">
                <label class="resource-label">{{localize "Ex3.Reroll"}}</label>
            </div>
            <div class="resource d-flex flex-center">
                <div>
                    <div>1</div>
                    <input name="system.diceroller.reroll.one" type="checkbox" {{checked system.diceroller.reroll.one}}>
                </div>
                <div>
                    <div>2</div>
                    <input name="system.diceroller.reroll.two" type="checkbox" {{checked system.diceroller.reroll.two}}>
                </div>
                <div>
                    <div>3</div>
                    <input name="system.diceroller.reroll.three" type="checkbox" {{checked
                        system.diceroller.reroll.three}}>
                </div>
                <div>
                    <div>4</div>
                    <input name="system.diceroller.reroll.four" type="checkbox" {{checked
                        system.diceroller.reroll.four}}>
                </div>
                <div>
                    <div>5</div>
                    <input name="system.diceroller.reroll.five" type="checkbox" {{checked
                        system.diceroller.reroll.five}}>
                </div>
                <div>
                    <div>6</div>
                    <input name="system.diceroller.reroll.six" type="checkbox" {{checked system.diceroller.reroll.six}}>
                </div>
                <div>
                    <div>7</div>
                    <input name="system.diceroller.reroll.seven" type="checkbox" {{checked
                        system.diceroller.reroll.seven}}>
                </div>
                <div>
                    <div>8</div>
                    <input name="system.diceroller.reroll.eight" type="checkbox" {{checked
                        system.diceroller.reroll.eight}}>
                </div>
                <div>
                    <div>9</div>
                    <input name="system.diceroller.reroll.nine" type="checkbox" {{checked
                        system.diceroller.reroll.nine}}>
                </div>
                <div>
                    <div>10</div>
                    <input name="system.diceroller.reroll.ten" type="checkbox" {{checked system.diceroller.reroll.ten}}>
                </div>
            </div>
            <div class="resource flex-center">
                <label class="resource-label">{{localize "Ex3.RerollsCap"}}* <i
                        title="Effects 'Rerolls 6s' style rerolls, 0 means no cap"
                        class="fas fa-info-circle"></i></label>
            </div>
            <div class="resource d-flex flex-center mb-1">
                <div class="resource d-flex flex-center">
                    <div>
                        <div>1</div>
                        <input name="system.diceroller.rerollcap.one" value="{{system.diceroller.rerollcap.one}}"
                            type="text">
                    </div>
                    <div>
                        <div>2</div>
                        <input name="system.diceroller.rerollcap.two" value="{{system.diceroller.rerollcap.two}}"
                            type="text">
                    </div>
                    <div>
                        <div>3</div>
                        <input name="system.diceroller.rerollcap.three" value="{{system.diceroller.rerollcap.three}}"
                            type="text">
                    </div>
                    <div>
                        <div>4</div>
                        <input name="system.diceroller.rerollcap.four" value="{{system.diceroller.rerollcap.four}}"
                            type="text">
                    </div>
                    <div>
                        <div>5</div>
                        <input name="system.diceroller.rerollcap.five" value="{{system.diceroller.rerollcap.five}}"
                            type="text">
                    </div>
                    <div>
                        <div>6</div>
                        <input name="system.diceroller.rerollcap.six" value="{{system.diceroller.rerollcap.six}}"
                            type="text">
                    </div>
                    <div>
                        <div>7</div>
                        <input name="system.diceroller.rerollcap.seven" value="{{system.diceroller.rerollcap.seven}}"
                            type="text">
                    </div>
                    <div>
                        <div>8</div>
                        <input name="system.diceroller.rerollcap.eight" value="{{system.diceroller.rerollcap.eight}}"
                            type="text">
                    </div>
                    <div>
                        <div>9</div>
                        <input name="system.diceroller.rerollcap.nine" value="{{system.diceroller.rerollcap.nine}}"
                            type="text">
                    </div>
                    <div>
                        <div>10</div>
                        <input name="system.diceroller.rerollcap.ten" value="{{system.diceroller.rerollcap.ten}}"
                            type="text">
                    </div>
                </div>
            </div>
            <div class="resource flex-center">
                <label class="resource-label">{{localize "Ex3.DoubleSuccessCap"}}*</label>
            </div>
            <div class="resource grid grid-4col flex-center">
                <div>
                    <label class="resource-label">{{localize "Ex3.Sevens"}}</label>
                    <input name="system.diceroller.doublesucccesscaps.sevens"
                        value="{{system.diceroller.doublesucccesscaps.sevens}}" type="text">
                </div>
                <div>
                    <label class="resource-label">{{localize "Ex3.Eights"}}</label>
                    <input name="system.diceroller.doublesucccesscaps.eights"
                        value="{{system.diceroller.doublesucccesscaps.eights}}" type="text">
                </div>
                <div>
                    <label class="resource-label">{{localize "Ex3.Nines"}}</label>
                    <input name="system.diceroller.doublesucccesscaps.nines"
                        value="{{system.diceroller.doublesucccesscaps.nines}}" type="text">
                </div>
                <div>
                    <label class="resource-label">{{localize "Ex3.Tens"}}</label>
                    <input name="system.diceroller.doublesucccesscaps.tens"
                        value="{{system.diceroller.doublesucccesscaps.tens}}" type="text">
                </div>
            </div>
            <div class="resource grid grid-2col flex-center">
                <div>
                    <div class="resource-label">{{localize "Ex3.TriggerOnTens"}}</div>
                    <select name="system.diceroller.triggerontens" data-type="String">
                        {{#select system.diceroller.triggerontens}}
                        <option value="none">{{localize "Ex3.Nothing"}}</option>
                        <option value="damage">{{localize "Ex3.Damage"}}</option>
                        <option value="extraSuccess">{{localize "Ex3.ExtraSuccess"}}</option>
                        <option value="ignoreHardness">{{localize "Ex3.IgnoreHardness"}}</option>
                        <option value="postSoakDamage">{{localize "Ex3.PostSoakDamage"}}</option>
                        <option value="rerolllDie">{{localize "Ex3.RerollDie"}}</option>
                        <option value="restoreMote">{{localize "Ex3.RestoreMote"}}</option>
                        {{/select}}
                    </select>
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.TriggerTensCap"}}*</div>
                    <input name="system.diceroller.triggertenscap" value="{{system.diceroller.triggertenscap}}"
                        type="text">
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.AlsoTriggerNines"}}</div>
                    <input name="system.diceroller.alsotriggernines" type="checkbox" {{checked
                        system.diceroller.alsotriggernines}}>
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.ExcludeOnesFromRerolls"}}</div>
                    <input name="system.diceroller.excludeonesfromrerolls" type="checkbox" {{checked
                        system.diceroller.excludeonesfromrerolls}}>
                </div>
            </div>
            <div class="flex-center resource-label" style="font-weight: bold;font-size:17px;">
                {{localize "Ex3.Damage"}}
            </div>
            <div>
                <div class="resource grid grid-3col flex-center">
                    <div>
                        <label class="resource-label">{{localize "Ex3.DamageDice"}}*</label>
                        <input type="text" name="system.diceroller.damage.bonusdice"
                            value="{{system.diceroller.damage.bonusdice}}">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.DamageSuccesses"}}*</label>
                        <input type="text" name="system.diceroller.damage.bonussuccesses"
                            value="{{system.diceroller.damage.bonussuccesses}}">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.DoubleSuccess"}} + </label>
                        <input type="number" name="system.diceroller.damage.doublesuccess"
                            value="{{system.diceroller.damage.doublesuccess}}">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.DecreaseTargetNumber"}} </label>
                        <input type="number" name="system.diceroller.damage.decreasetargetnumber"
                            value="{{system.diceroller.damage.decreasetargetnumber}}">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.RerollFailedDice"}}*</label>
                        <input name="system.diceroller.damage.rerolldice"
                            value="{{system.diceroller.damage.rerolldice}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.RerollAllFailedOnce"}} </label>
                        <div>
                            <input type="checkbox" name="system.diceroller.damage.rerollfailed" {{checked
                                system.diceroller.damage.rerollfailed}}>
                        </div>
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.RollTwiceKeepHighest"}} </label>
                        <div>
                            <input type="checkbox" name="system.diceroller.damage.rolltwice" {{checked
                                system.diceroller.damage.rolltwice}}>
                        </div>
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.Overwhelming"}}*</label>
                        <input type="text" name="system.diceroller.damage.overwhelming"
                            value="{{system.diceroller.damage.overwhelming}}">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.PostSoakDamage"}}*</label>
                        <input type="text" name="system.diceroller.damage.postsoakdamage"
                            value="{{system.diceroller.damage.postsoakdamage}}">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.IgnoreSoak"}}*</label>
                        <input type="text" name="system.diceroller.damage.ignoresoak"
                            value="{{system.diceroller.damage.ignoresoak}}">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.IgnoreHardness"}}*</label>
                        <input type="text" name="system.diceroller.damage.ignorehardness"
                            value="{{system.diceroller.damage.ignorehardness}}">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.DicetoSuccesses"}}*</label>
                        <input name="system.diceroller.damage.dicetosuccesses"
                            value="{{system.diceroller.damage.dicetosuccesses}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.ThreshholdToDamage"}} </label>
                        <div>
                            <input type="checkbox" name="system.diceroller.damage.threshholdtodamage" {{checked
                                system.diceroller.damage.threshholdtodamage}}>
                        </div>
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.DoubleRolledDamage"}} </label>
                        <div>
                            <input type="checkbox" name="system.diceroller.damage.doublerolleddamage" {{checked
                                system.diceroller.damage.doublerolleddamage}}>
                        </div>
                    </div>
                </div>
                <div class="resource flex-center">
                    <label class="resource-label">{{localize "Ex3.Reroll"}}</label>
                </div>
                <div class="resource d-flex flex-center">
                    <div>
                        <div>1</div>
                        <input name="system.diceroller.damage.reroll.one" type="checkbox" {{checked
                            system.diceroller.damage.reroll.one}}>
                    </div>
                    <div>
                        <div>2</div>
                        <input name="system.diceroller.damage.reroll.two" type="checkbox" {{checked
                            system.diceroller.damage.reroll.two}}>
                    </div>
                    <div>
                        <div>3</div>
                        <input name="system.diceroller.damage.reroll.three" type="checkbox" {{checked
                            system.diceroller.damage.reroll.three}}>
                    </div>
                    <div>
                        <div>4</div>
                        <input name="system.diceroller.damage.reroll.four" type="checkbox" {{checked
                            system.diceroller.damage.reroll.four}}>
                    </div>
                    <div>
                        <div>5</div>
                        <input name="system.diceroller.damage.reroll.five" type="checkbox" {{checked
                            system.diceroller.damage.reroll.five}}>
                    </div>
                    <div>
                        <div>6</div>
                        <input name="system.diceroller.damage.reroll.six" type="checkbox" {{checked
                            system.diceroller.damage.reroll.six}}>
                    </div>
                    <div>
                        <div>7</div>
                        <input name="system.diceroller.damage.reroll.seven" type="checkbox" {{checked
                            system.diceroller.damage.reroll.seven}}>
                    </div>
                    <div>
                        <div>8</div>
                        <input name="system.diceroller.damage.reroll.eight" type="checkbox" {{checked
                            system.diceroller.damage.reroll.eight}}>
                    </div>
                    <div>
                        <div>9</div>
                        <input name="system.diceroller.damage.reroll.nine" type="checkbox" {{checked
                            system.diceroller.damage.reroll.nine}}>
                    </div>
                    <div>
                        <div>10</div>
                        <input name="system.diceroller.damage.reroll.ten" type="checkbox" {{checked
                            system.diceroller.damage.reroll.ten}}>
                    </div>
                </div>
                <div class="resource flex-center">
                    <label class="resource-label">{{localize "Ex3.RerollsCap"}}*</label>
                </div>
                <div class="resource d-flex flex-center mb-1">
                    <div class="resource d-flex flex-center">
                        <div>
                            <div>1</div>
                            <input name="system.diceroller.damage.rerollcap.one" value="{{system.diceroller.damage.rerollcap.one}}" type="text">
                        </div>
                        <div>
                            <div>2</div>
                            <input name="system.diceroller.damage.rerollcap.two" value="{{system.diceroller.damage.rerollcap.two}}" type="text">
                        </div>
                        <div>
                            <div>3</div>
                            <input name="system.diceroller.damage.rerollcap.three" value="{{system.diceroller.damage.rerollcap.three}}" type="text">
                        </div>
                        <div>
                            <div>4</div>
                            <input name="system.diceroller.damage.rerollcap.four" value="{{system.diceroller.damage.rerollcap.four}}" type="text">
                        </div>
                        <div>
                            <div>5</div>
                            <input name="system.diceroller.damage.rerollcap.five" value="{{system.diceroller.damage.rerollcap.five}}" type="text">
                        </div>
                        <div>
                            <div>6</div>
                            <input name="system.diceroller.damage.rerollcap.six" value="{{system.diceroller.damage.rerollcap.six}}" type="text">
                        </div>
                        <div>
                            <div>7</div>
                            <input name="system.diceroller.damage.rerollcap.seven" value="{{system.diceroller.damage.rerollcap.seven}}" type="text">
                        </div>
                        <div>
                            <div>8</div>
                            <input name="system.diceroller.damage.rerollcap.eight" value="{{system.diceroller.damage.rerollcap.eight}}" type="text">
                        </div>
                        <div>
                            <div>9</div>
                            <input name="system.diceroller.damage.rerollcap.nine" value="{{system.diceroller.damage.rerollcap.nine}}" type="text">
                        </div>
                        <div>
                            <div>10</div>
                            <input name="system.diceroller.damage.rerollcap.ten" value="{{system.diceroller.damage.rerollcap.ten}}" type="text">
                        </div>
                    </div>
                </div>
                <div class="resource flex-center">
                    <label class="resource-label">{{localize "Ex3.DoubleSuccessCap"}}*</label>
                </div>
                <div class="resource grid grid-4col flex-center">
                    <div>
                        <label class="resource-label">{{localize "Ex3.Sevens"}}</label>
                        <input name="system.diceroller.damage.doublesucccesscaps.sevens"
                            value="{{system.diceroller.damage.doublesucccesscaps.sevens}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.Eights"}}</label>
                        <input name="system.diceroller.damage.doublesucccesscaps.eights"
                            value="{{system.diceroller.damage.doublesucccesscaps.eights}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.Nines"}}</label>
                        <input name="system.diceroller.damage.doublesucccesscaps.nines"
                            value="{{system.diceroller.damage.doublesucccesscaps.nines}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.Tens"}}</label>
                        <input name="system.diceroller.damage.doublesucccesscaps.tens"
                            value="{{system.diceroller.damage.doublesucccesscaps.tens}}" type="text">
                    </div>
                </div>
                <div class="resource grid grid-2col flex-center">
                    <div>
                        <div class="resource-label">{{localize "Ex3.TriggerOnTens"}}</div>
                        <select name="system.diceroller.damage.triggerontens" data-type="String">
                            {{#select system.diceroller.damage.triggerontens}}
                            <option value="none">{{localize "Ex3.Nothing"}}</option>
                            <option value="subtractTargetInitiative">{{localize "Ex3.SubtractTargetInitiative"}}
                            </option>
                            {{/select}}
                        </select>
                    </div>
                    <div>
                        <div class="resource-label">{{localize "Ex3.TriggerTensCap"}}*</div>
                        <input name="system.diceroller.damage.triggertenscap"
                            value="{{system.diceroller.damage.triggertenscap}}" type="text">
                    </div>
                    <div>
                        <div class="resource-label">{{localize "Ex3.AlsoTriggerNines"}}</div>
                        <input name="system.diceroller.damage.alsotriggernines" type="checkbox" {{checked
                            system.diceroller.damage.alsotriggernines}}>
                    </div>
                    <div>
                        <div class="resource-label">{{localize "Ex3.ExcludeOnesFromRerolls"}}</div>
                        <input name="system.diceroller.damage.excludeonesfromrerolls" type="checkbox" {{checked
                            system.diceroller.damage.excludeonesfromrerolls}}>
                    </div>
                </div>
            </div>
            <div class="flex-center resource-label" style="font-weight: bold;font-size:17px;">
                {{localize "Ex3.OtherBonuses"}}
            </div>
            <div class="resource grid grid-2col flex-center">
                <div>
                    <label class="resource-label">{{localize "Ex3.SelfDefensePenalty"}}</label>
                    <input name="system.diceroller.selfdefensepenalty" value="{{system.diceroller.selfdefensepenalty}}"
                        type="number">
                </div>
                <div>
                    <label class="resource-label">{{localize "Ex3.TargetDefensePenalty"}}</label>
                    <input name="system.diceroller.targetdefensepenalty"
                        value="{{system.diceroller.targetdefensepenalty}}" type="number">
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.ActivateAura"}}</div>
                    <select name="system.diceroller.activateAura" data-type="String">
                        {{#select system.diceroller.activateAura}}
                        <option value="none">{{localize "Ex3.None"}}</option>
                        <option value="air">{{localize "Ex3.Air"}}</option>
                        <option value="earth">{{localize "Ex3.Earth"}}</option>
                        <option value="fire">{{localize "Ex3.Fire"}}</option>
                        <option value="water">{{localize "Ex3.Water"}}</option>
                        <option value="wood">{{localize "Ex3.Wood"}}</option>
                        {{/select}}
                    </select>
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.IgnoreLegendarySize"}}</div>
                    <input name="system.diceroller.ignorelegendarysize" type="checkbox" {{checked
                        system.diceroller.ignorelegendarysize}}>
                </div>
            </div>
            <hr>
            <div class="d-flex flex-center resource-label" style="font-weight: bold;font-size: 17px;">
                <div>
                    {{localize "Ex3.OpposedBonuses"}}
                </div>
                <input name="system.diceroller.opposedbonuses.enabled" type="checkbox" {{checked
                    system.diceroller.opposedbonuses.enabled}}>
            </div>
            <div>
                <div class="resource grid grid-3col flex-center">
                    <div>
                        <label class="resource-label">{{localize "Ex3.DiceModifier"}}*</label>
                        <input name="system.diceroller.opposedbonuses.dicemodifier"
                            value="{{system.diceroller.opposedbonuses.dicemodifier}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.SuccessModifier"}}*</label>
                        <input name="system.diceroller.opposedbonuses.successmodifier"
                            value="{{system.diceroller.opposedbonuses.successmodifier}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.RerollSuccesses"}}*</label>
                        <input name="system.diceroller.opposedbonuses.rerollsuccesses"
                            value="{{system.diceroller.opposedbonuses.rerollsuccesses}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.Resolve"}}*</label>
                        <input name="system.diceroller.opposedbonuses.resolve"
                            value="{{system.diceroller.opposedbonuses.resolve}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.Guile"}}*</label>
                        <input name="system.diceroller.opposedbonuses.guile"
                            value="{{system.diceroller.opposedbonuses.guile}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.IncreaseTargetNumber"}}</label>
                        <input name="system.diceroller.opposedbonuses.increasetargetnumber"
                            value="{{system.diceroller.opposedbonuses.increasetargetnumber}}" type="number">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.Defense"}}*</label>
                        <input name="system.diceroller.opposedbonuses.defense"
                            value="{{system.diceroller.opposedbonuses.defense}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.Soak"}}*</label>
                        <input name="system.diceroller.opposedbonuses.soak"
                            value="{{system.diceroller.opposedbonuses.soak}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.Hardness"}}*</label>
                        <input name="system.diceroller.opposedbonuses.hardness"
                            value="{{system.diceroller.opposedbonuses.hardness}}" type="text">
                    </div>
                    {{#if useShieldInitiative}}
                    <div>
                        <label class="resource-label">{{localize "Ex3.ShieldInitiative"}}*</label>
                        <input name="system.diceroller.opposedbonuses.shieldinitiative"
                            value="{{system.diceroller.opposedbonuses.shieldinitiative}}" type="text">
                    </div>
                    {{/if}}
                    <div>
                        <label class="resource-label">{{localize "Ex3.DamageModifier"}}*</label>
                        <input name="system.diceroller.opposedbonuses.damagemodifier"
                            value="{{system.diceroller.opposedbonuses.damagemodifier}}" type="text">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.IncreaseDamageTN"}}</label>
                        <input name="system.diceroller.opposedbonuses.increasedamagetargetnumber"
                            value="{{system.diceroller.opposedbonuses.increasedamagetargetnumber}}" type="number">
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.IncreaseGambitDifficulty"}}*</label>
                        <input name="system.diceroller.opposedbonuses.increasegambitdifficulty"
                            value="{{system.diceroller.opposedbonuses.increasegambitdifficulty}}" type="text">
                    </div>
                </div>
                <div class="resource grid grid-2col flex-center" style="padding-bottom:20px;">
                    <div>
                        <div class="resource-label">{{localize "Ex3.TriggerOnOnes"}}</div>
                        <select name="system.diceroller.opposedbonuses.triggeronones" data-type="String">
                            {{#select system.diceroller.opposedbonuses.triggeronones}}
                            <option value="none">{{localize "Ex3.Nothing"}}</option>
                            <option value="soak">{{localize "Ex3.IncreaseSoak"}}</option>
                            <option value="defense">{{localize "Ex3.IncreaseDefense"}}</option>
                            <option value="rerollSuccesses">{{localize "Ex3.RerollSuccesses"}}</option>
                            <option value="subtractInitiative">{{localize "Ex3.SubtractEnemyInitiative"}}</option>
                            <option value="subtractSuccesses">{{localize "Ex3.SubtractEnemySuccesses"}}</option>
                            {{/select}}
                        </select>
                    </div>
                    <div>
                        <label class="resource-label">{{localize "Ex3.TriggerOnesCap"}}*</label>
                        <input name="system.diceroller.opposedbonuses.triggeronescap"
                            value="{{system.diceroller.opposedbonuses.triggeronescap}}" type="text">
                    </div>
                    <div>
                        <div class="resource-label">{{localize "Ex3.AlsoTriggerTwos"}}</div>
                        <input name="system.diceroller.alsotriggertwos" type="checkbox" {{checked
                            system.diceroller.alsotriggertwos}}>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab" data-group="primary" data-tab="triggers">
            <div class="resource flex-center mb-1" style="font-size: 17px;">
                <a><i class="fas fa-info-circle show-roll-triggers-link cursor-pointer"></i></a> <label
                    class="resource-label">{{localize "Ex3.DiceRollTriggers"}} <a class="item-control add-trigger"
                        title="Create trigger" data-type="dicerollertriggers"><i class="fas fa-plus"></i></a></label>
            </div>
            {{#each system.triggers.dicerollertriggers as |trigger index|}}
            <div class="flex-group-center mb-1">
                <div class="grid grid-2col flex-center">
                    <div>
                        <div>
                            <label class="resource-label">{{localize "Ex3.Name"}}</label>
                        </div>
                        <div class="d-flex" style="align-items:center; margin-bottom: 10px;">
                            <input name="system.triggers.dicerollertriggers.{{index}}.name" class="trigger-name"
                                value="{{trigger.name}}" type="text" data-index="{{index}}"
                                data-type="dicerollertriggers">
                        </div>
                    </div>
                    <div>
                        <div style="margin-right: 30px;">
                            <label class="resource-label">{{localize "Ex3.TriggerTime"}}</label>
                        </div>
                        <div class="d-flex" style="align-items:center; margin-bottom: 10px;justify-content:center;">
                            <select name="system.triggers.dicerollertriggers.{{index}}.triggerTime" data-type="String">
                                {{#select trigger.triggerTime}}
                                <option value="beforeRoll">{{localize "Ex3.BeforeRoll"}}</option>
                                {{/select}}
                            </select>
                            <a class="item-control delete-trigger" title="Delete trigger" data-type="dicerollertriggers"
                                data-index="{{index}}"><i class="fas fa-trash"
                                    style="margin-right: 15px; margin-left:15px;"></i></a>
                        </div>
                    </div>
                </div>
                <div class="resource flex-center mb-1" style="font-size: 17px;">
                    <label class="resource-label">{{localize "Ex3.Bonuses"}} <a class="item-control add-trigger-subitem"
                            title="Create bonus" data-type="dicerollertriggers" data-subtype="bonuses"
                            data-index="{{index}}"><i class="fas fa-plus"></i></a></label>
                </div>
                <div class="grid grid-2col flex-center">
                    {{#each trigger.bonuses as |bonus bonusIndex|}}
                    <div>
                        <div class="resource-label">{{localize "Ex3.Effect"}}</div>
                        <select name="system.triggers.dicerollertriggers.{{index}}.bonuses.{{bonusIndex}}.effect"
                            data-type="String">
                            {{#select bonus.effect}}
                            <option value="">{{localize "Ex3.None"}}</option>
                            <optgroup label="{{localize 'Ex3.DiceRoll'}}">
                                <option value="diceModifier">{{localize "Ex3.DiceModifier"}}</option>
                                <option value="successModifier">{{localize "Ex3.SuccessModifier"}}</option>
                                <option value="doubleSuccess">{{localize "Ex3.DoubleSuccess"}}+</option>
                                <option value="decreaseTargetNumber">{{localize "Ex3.DecreaseTargetNumber"}}</option>
                                <option value="rerollDice">{{localize "Ex3.RerollNumberDice"}}</option>
                                <option value="diceToSuccesses">{{localize "Ex3.DicetoSuccesses"}}</option>
                                <option value="reduceDifficulty">{{localize "Ex3.ReduceDifficulty"}}</option>
                                <option value="rerollDieFace">{{localize "Ex3.RerollDieFace"}}</option>
                                <option value="rollTwice">{{localize "Ex3.RollTwiceKeepHighest"}}</option>
                                <option value="excludeOnes">{{localize "Ex3.ExcludeOnesFromRerolls"}}</option>
                                <option value="rerollFailed">{{localize "Ex3.RerollFailed"}}</option>
                                <option value="triggerOnTens">{{localize "Ex3.TriggerTens"}}</option>
                                <option value="triggerNinesAndTens">{{localize "Ex3.TriggerNines&Tens"}}</option>
                                <option value="triggerTensCap">{{localize "Ex3.TriggerTensCap"}}</option>
                            </optgroup>
                            <optgroup label="{{localize 'Ex3.Damage'}}">
                                <option value="damageDice">{{localize "Ex3.DiceModifier"}}</option>
                                <option value="damageSuccessModifier">{{localize "Ex3.SuccessModifier"}}</option>
                                <option value="doubleSuccess-damage">{{localize "Ex3.DoubleSuccess"}}+</option>
                                <option value="diceToSuccesses-damage">{{localize "Ex3.DicetoSuccesses"}}</option>
                                <option value="decreaseTargetNumber-damage">{{localize "Ex3.DecreaseTargetNumber"}}
                                </option>
                                <option value="rerollDieFace-damage">{{localize "Ex3.RerollDieFace"}}</option>
                                <option value="rerollNumberDice-damage">{{localize "Ex3.RerollNumberDice"}}</option>
                                <option value="rollTwice-damage">{{localize "Ex3.RollTwiceKeepHighest"}}</option>
                                <option value="excludeOnes-damage">{{localize "Ex3.ExcludeOnesFromRerolls"}}</option>
                                <option value="rerollFailed-damage">{{localize "Ex3.RerollFailed"}}</option>
                                <option value="triggerOnTens-damage">{{localize "Ex3.TriggerTens"}}</option>
                                <option value="triggerTensCap-damage">{{localize "Ex3.TriggerTensCap"}}</option>
                                <option value="triggerNinesAndTens-damage">{{localize "Ex3.TriggerNines&Tens"}}</option>
                                <option value="threshholdToDamage">{{localize "Ex3.ThreshholdToDamage"}}</option>
                                <option value="doubleRolledDamage">{{localize "Ex3.DoubleRolledDamage"}}</option>
                                <option value="ignoreSoak">{{localize "Ex3.IgnoreSoak"}}</option>
                                <option value="overwhelming">{{localize "Ex3.Overwhelming"}}</option>
                                <option value="postSoakDamage">{{localize "Ex3.PostSoakDamage"}}</option>
                                <option value="noInitiativeReset">{{localize "Ex3.NoInitiativeReset"}}</option>
                            </optgroup>
                            <optgroup label="{{localize 'Ex3.Spend'}}">
                                <option value="motes-spend">{{localize "Ex3.Motes"}}</option>
                                <option value="muteMotes-spend">{{localize "Ex3.MuteMotes"}}</option>
                                <option value="initiative-spend">{{localize "Ex3.Initiative"}}</option>
                                <option value="anima-spend">{{localize "Ex3.Anima"}}</option>
                                <option value="willpower-spend">{{localize "Ex3.Willpower"}}</option>
                                <option value="grappleControl-spend">{{localize "Ex3.GrappleControl"}}</option>
                                <option value="health-spend">{{localize "Ex3.Health"}}</option>
                                <option value="aura-spend">{{localize "Ex3.Aura"}}</option>
                                <option value="penumbra-spend">{{localize "Ex3.Penumbra"}}</option>
                                <option value="silverXp-spend">{{localize "Ex3.SilverXP"}}</option>
                                <option value="goldXp-spend">{{localize "Ex3.GoldXP"}}</option>
                                <option value="whiteXp-spend">{{localize "Ex3.WhiteXP"}}</option>
                            </optgroup>
                            <optgroup label="{{localize 'Ex3.Restore'}}">
                                <option value="motes-restore">{{localize "Ex3.Motes"}}</option>
                                <option value="willpower-restore">{{localize "Ex3.Willpower"}}</option>
                                <option value="health-restore">{{localize "Ex3.Health"}}</option>
                                <option value="initiative-restore">{{localize "Ex3.Initiative"}}</option>
                            </optgroup>
                            <optgroup label="{{localize 'Ex3.Other'}}">
                                <option value="triggerSelfDefensePenalty">{{localize "Ex3.SelfDefensePenalty"}}</option>
                                <option value="triggerTargetDefensePenalty">{{localize "Ex3.TargetDefensePenalty"}}
                                </option>
                                <option value="activateAura">{{localize "Ex3.ActivateAura"}}</option>
                                <option value="ignoreLegendarySize">{{localize "Ex3.IgnoreLegendarySize"}}</option>
                                <option value="inflictDicePenalty">{{localize "Ex3.InflictDicePenalty"}}</option>
                            </optgroup>
                            <optgroup label="{{localize 'Ex3.Defense'}}">
                                <option value="defense">{{localize "Ex3.Defense"}}</option>
                                <option value="soak">{{localize "Ex3.Soak"}}</option>
                                <option value="hardness">{{localize "Ex3.Hardness"}}</option>
                                <option value="resolve">{{localize "Ex3.Resolve"}}</option>
                                <option value="guile">{{localize "Ex3.Guile"}}</option>
                            </optgroup>
                            {{/select}}
                        </select>
                    </div>
                    <div>
                        <div class="resource-label" style="margin-right: 30px;">{{localize "Ex3.Value"}}*</div>
                        <div class="d-flex" style="align-items:center;">
                            <input name="system.triggers.dicerollertriggers.{{index}}.bonuses.{{bonusIndex}}.value"
                                value="{{bonus.value}}" type="text">
                            <a class="item-control delete-trigger-subitem" title="Delete bonus"
                                data-type="dicerollertriggers" data-index="{{index}}" data-subindex="{{bonusIndex}}"
                                data-subtype="bonuses"><i class="fas fa-trash"
                                    style="margin-right: 15px; margin-left: 15px;"></i></a>
                        </div>
                    </div>
                    {{/each}}
                </div>
                <div class="resource flex-center mb-1" style="font-size: 17px;">
                    <label class="resource-label">{{localize "Ex3.Requirements"}} <a
                            class="item-control add-trigger-subitem" title="Create requirement"
                            data-type="dicerollertriggers" data-subtype="requirements" data-index="{{index}}"><i
                                class="fas fa-plus"></i></a></label>
                </div>
                <div class="grid grid-2col flex-center">
                    {{#each trigger.requirements as |requirement requirementIndex|}}
                    <div>
                        <div class="resource-label">{{localize "Ex3.Effect"}}</div>
                        <select
                            name="system.triggers.dicerollertriggers.{{index}}.requirements.{{requirementIndex}}.requirement"
                            data-type="String">
                            {{#select requirement.requirement}}
                            <option value="">{{localize "Ex3.None"}}</option>
                            <optgroup label="{{localize 'Ex3.Roll'}}">
                                <option value="attackType">{{localize "Ex3.AttackType"}}</option>
                                <option value="charmAddedAmount">{{localize "Ex3.CharmAddedAmount"}}</option>
                                <option value="range">{{localize "Ex3.Range"}}</option>
                            </optgroup>
                            <optgroup label="{{localize 'Ex3.Character'}}">
                                <option value="martialArtsLevel">{{localize "Ex3.MartialArtsTier"}}</option>
                                <option value="smaLevel">{{localize "Ex3.SiderealMATier"}}</option>
                                <option value="formula">{{localize "Ex3.Formula"}}</option>
                                <option value="hasStatus">{{localize "Ex3.HasStatus"}}</option>
                            </optgroup>
                            <optgroup label="{{localize 'Ex3.Target'}}">
                                <option value="targetHasStatus">{{localize "Ex3.TargetHasStatus"}}</option>
                                <option value="targetIsBattlegroup">{{localize "Ex3.TargetIsBattlegroup"}}</option>
                                <option value="targetIsCrashed">{{localize "Ex3.TargetIsCrashed"}}</option>
                            </optgroup>
                            <optgroup label="{{localize 'Ex3.RollResults'}}">
                                <option value="thresholdSuccesses">{{localize "Ex3.ThresholdSuccesses"}}</option>
                                <option value="damageLevelsDealt">{{localize "Ex3.DamageLevelsDealt"}}+</option>
                                <option value="crashedTheTarget">{{localize "Ex3.CrashedTheTarget"}}</option>
                            </optgroup>
                            {{/select}}
                        </select>
                    </div>
                    <div>
                        <div class="resource-label" style="margin-right: 30px;">{{localize "Ex3.Value"}}</div>
                        <div class="d-flex" style="align-items:center;">
                            <input
                                name="system.triggers.dicerollertriggers.{{index}}.requirements.{{requirementIndex}}.value"
                                value="{{requirement.value}}" type="text">
                            <a class="item-control delete-trigger-subitem" title="Delete bonus"
                                data-type="dicerollertriggers" data-index="{{index}}"
                                data-subindex="{{requirementIndex}}" data-subtype="requirements"><i class="fas fa-trash"
                                    style="margin-right: 15px; margin-left: 15px;"></i></a>
                        </div>
                    </div>
                    {{/each}}
                </div>
            </div>
            {{/each}}
        </div>

        <div class="tab" data-group="primary" data-tab="macros">
            <div class="resource-label list-section-header d-flex flex-between">
                <div>
                    {{localize "Ex3.PreRollMacro"}}
                </div>
            </div>
            <div class="flex-group-center d-flex flex-col">
                <textarea type="text" name="system.prerollmacro" rows="16"
                    placeholder='{{localize "Ex3.PreRollMacroHint"}}'>{{system.prerollmacro}}</textarea>
            </div>
            <div class="resource-label list-section-header d-flex flex-between">
                <div>
                    {{localize "Ex3.Macro"}}
                </div>
            </div>
            <div class="flex-group-center d-flex flex-col">
                <textarea type="text" name="system.macro" rows="16"
                    placeholder='{{localize "Ex3.MacroHint"}}'>{{system.macro}}</textarea>
            </div>
            <div class="resource-label list-section-header d-flex flex-between">
                <div>
                    {{localize "Ex3.DamageMacro"}}
                </div>
            </div>
            <div class="flex-group-center d-flex flex-col flex-fill">
                <textarea class="flex-fill" type="text" name="system.damagemacro" rows="16"
                    placeholder='{{localize "Ex3.DamageMacroHint"}}'>{{system.damagemacro}}</textarea>
            </div>
        </div>

        <div id="other-tab" class="tab" data-group="primary" data-tab="other">
            <div class="flex-group-center">
                <label class="resource-label">{{localize "Ex3.Summary"}}</label>
                <textarea type="text" name="system.summary" rows="4">{{system.summary}}</textarea>
            </div>
            <div class="grid grid-2col flex-group-center">
                <div>
                    <div class="resource-label">{{localize "Ex3.CharmType"}}</div>
                    <select name="system.charmtype" data-type="String">
                        {{#select system.charmtype}}
                        {{#each charmExaltType as |label type|}}
                        <option value="{{type}}">{{localize label}}</option>
                        {{/each}}
                        {{/select}}
                    </select>
                </div>
                <div>
                    <div class="flex-center">
                        <div class="resource-label">{{localize "Ex3.ListingName"}}</div>
                    </div>
                    <input type="text" name="system.listingname" value="{{system.listingname}}"
                        placeholder="Defaults to ability name" />
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.EndTrigger"}}</div>
                    <select name="system.endtrigger" data-type="String">
                        {{#select system.endtrigger}}
                        <option value="none">{{localize "Ex3.None"}}</option>
                        <option value="startturn">{{localize "Ex3.StartTurn"}}</option>
                        <option value="endturn">{{localize "Ex3.EndTurn"}}</option>
                        <option value="endscene">{{localize "Ex3.EndScene"}}</option>
                        {{/select}}
                    </select>
                </div>
                <div>
                    <div class="resource-label">{{localize "Ex3.AutoAddToRolls"}}</div>
                    <select name="system.autoaddtorolls" data-type="String">
                        {{#select system.autoaddtorolls}}
                        <option value="">{{localize "Ex3.None"}}</option>
                        <option value="action">{{localize "Ex3.CharacterRolls"}}</option>
                        <option value="attacks">{{localize "Ex3.Attacks"}}</option>
                        <option value="opposedRolls">{{localize "Ex3.OpposedRolls"}}</option>
                        <option value="sameAbility">{{localize "Ex3.SameAbilityAttribute"}}</option>
                        {{/select}}
                    </select>
                </div>
                <div>
                    <label class="resource-label">{{localize "Ex3.Activatable"}}</label>
                    <div>
                        <input name="system.activatable" type="checkbox" {{checked system.activatable}}>
                    </div>
                </div>
                <!-- <div>
                    <div class="resource-label">{{localize "Ex3.Restriction"}}</div>
                    <select name="system.userestriction" data-type="String">
                        {{#select system.userestriction}}
                        <option value="none">{{localize "Ex3.None"}}</option>
                        <option value="scene">{{localize "Ex3.OncePerScene"}}</option>
                        <option value="story">{{localize "Ex3.OncePerStory"}}</option>
                        {{/select}}
                    </select>
                </div> -->
            </div>
            <div class="d-flex flex-center resource-label">
                <div class="resource-label">{{localize "Ex3.PreviousCharmsPrerequisites"}}</div>
            </div>
            <div class="resource-content flexrow flex-center">
                <input placeholder="Previous Charms from: " type="number" name="system.numberprerequisites.number"
                    value="{{system.numberprerequisites.number}}" />
                <select name="system.numberprerequisites.ability" data-type="String">
                    {{#select system.numberprerequisites.ability}}
                    {{#each charmAbilityListSectioned as |charmCategory charmCategoryType|}}
                    <optgroup label="{{localize charmCategory.label}}">
                        {{#each charmCategory.entries as |entry entryType|}}
                        <option value="{{entryType}}">{{localize entry}}</option>
                        {{/each}}
                    </optgroup>
                    {{/each}}
                    <option value="combat">{{localize "Ex3.AnyCombatAbility"}}</option>
                    <option value="physicalAttribute">{{localize "Ex3.PhysicalAttribute"}}</option>
                    <option value="mentalAttribute">{{localize "Ex3.MentalAttribute"}}</option>
                    <option value="socialAttribute">{{localize "Ex3.SocialAttribute"}}</option>
                    <option value="">{{localize "Ex3.None"}}</option>
                    {{/select}}
                </select>
            </div>
            <div class="d-flex flex-center resource-label">
                <div class="resource-label">{{localize "Ex3.AlternatePrerequisites"}}</div>
            </div>
            <div>
                <label class="resource-label">{{localize "Ex3.Ability"}}: </label>
                <select name="system.archetype.ability" data-type="String">
                    {{#select system.archetype.ability}}
                    {{#each charmAbilityListSectioned as |charmCategory charmCategoryType|}}
                    <optgroup label="{{localize charmCategory.label}}">
                        {{#each charmCategory.entries as |entry entryType|}}
                        <option value="{{entryType}}">{{localize entry}}</option>
                        {{/each}}
                    </optgroup>
                    {{/each}}
                    <option value="combat">{{localize "Ex3.AnyCombatAbility"}}</option>
                    <option value="">{{localize "Ex3.None"}}</option>
                    {{/select}}
                </select>
            </div>
            <div class="flex-center mt-1">
                <div class="resource-label">{{localize "Ex3.CharmPrerequisites"}}</div>
            </div>
            <div class="embeded-item-list-wrapper" {{#if
                options.editable}}style="border: 1px solid var(--color-border-light-tertiary);" {{/if}}>
                <div class="flex-group-center embeded-item-list">
                    <ul>
                        {{#if options.editable}}
                        {{#each system.archetype.charmprerequisites as |item id|}}
                        <a draggable="true" class="embeded-item-pill" data-id="{{item.id}}"
                            data-item-name="{{item.name}}" data-item-index="{{id}}" data-type="archetype">
                            <li data-item-index="{{id}}">
                                {{item.name}}
                                <i data-type="archetype" class="fas fa-trash embeded-item-delete"></i>
                            </li>
                        </a>
                        {{/each}}
                        {{else}}
                        {{#each system.archetype.charmprerequisites as |item id|}}
                        <li class="embeded-item-pill" data-item-name="{{../name}}" data-item-index="{{id}}"
                            data-type="archetype">
                            {{item.name}}
                        </li>
                        {{/each}}
                        {{/if}}
                    </ul>
                </div>
            </div>
            <div class="flex-center mt-1">
                <div class="resource-label">{{localize "Ex3.OtherPrerequisites"}}</div>
            </div>
            <textarea type="text" name="system.archetype.prerequisites"
                rows="4">{{system.archetype.prerequisites}}</textarea>
            {{#if parentItemList}}
            <div>
                {{#ifEquals system.ability 'evocation'}}
                <div class="flex-center">
                    <div class="resource-label">{{localize "Ex3.Artifact"}}</div>
                </div>
                {{else}}
                <div class="flex-center">
                    <div class="resource-label">{{localize "Ex3.MartialArt"}}</div>
                </div>
                {{/ifEquals}}
                <select name="system.parentitemid" data-type="String">
                    {{#select system.parentitemid}}
                    <option value="">{{localize "Ex3.None"}}</option>
                    {{#each parentItemList as |item|}}
                    <option value="{{item._id}}">{{item.name}}</option>
                    {{/each}}
                    {{/select}}
                </select>
            </div>
            {{/if}}
            {{> systems/exaltedthird/templates/actor/active-effects.html}}
        </div>

    </section>
</form>