<form class="{{cssClass}} flexcol character-sheet-background" autocomplete="off">

  {{!-- Sheet Header --}}
  <header class="sheet-header">
    <div class="profile-img-wrapper">
      <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" height="100" width="100" />
      <div class="flex-center">
        <label class="resource-label">{{localize "Ex3.Essence"}}</label>
        <input type="number" name="data.essence.value" value="{{data.data.essence.value}}" data-dtype="Number" />
      </div>
    </div>
    <div class="header-fields">
      <div>
        <h1 class="charname"><input name="name" type="text" value="{{actor.name}}"
            placeholder="{{localize 'Ex3.NameTitle'}}" /></h1>
      </div>
      <div class="grid grid-2col flexrow">
        <h1 class="charname"> <select name="data.details.exalt" data-type="String">
            {{#select data.data.details.exalt}}
            <option value="abyssal">{{localize "Ex3.Abyssal"}}</option>
            <option value="alchemical">{{localize "Ex3.Alchemical"}}</option>
            <option value="dragonblooded">{{localize "Ex3.Dragonblooded"}}</option>
            <option value="exigent">{{localize "Ex3.Exigent"}}</option>
            <option value="getimian">{{localize "Ex3.Getimian"}}</option>
            <option value="infernal">{{localize "Ex3.Infernal"}}</option>
            <option value="liminal">{{localize "Ex3.Liminal"}}</option>
            <option value="lunar">{{localize "Ex3.Lunar"}}</option>
            <option value="sidereal">{{localize "Ex3.Sidereal"}}</option>
            <option value="solar">{{localize "Ex3.Solar"}}</option>
            <option value="other">{{localize "Ex3.Other"}}</option>
            {{/select}}
          </select></h1>
        <h1 class="charname"><input name="data.details.caste" type="text" value="{{data.data.details.caste}}"
            placeholder="{{localize 'Ex3.CasteAspect'}}" /></h1>
      </div>
      <div class="resources grid grid-3col">
        <div class="resource-content flexrow flex-center flex-between">
          <div>
            <label class="resource-label">{{localize "Ex3.Personal"}} <i class="fas fa-calculator calculate-personal-motes cursor-pointer" title="Auto Set Motes"></i></label>
            <div class="resource-content flexrow flex-center flex-between">
              <input type="number" name="data.motes.personal.value" value="{{data.data.motes.personal.value}}"
                data-dtype="Number" />
              /
              <input type="number" name="data.motes.personal.max" value="{{data.data.motes.personal.max}}"
                data-dtype="Number" />
            </div>
          </div>
          <div>
            <label class="resource-label">{{localize "Ex3.Peripheral"}} <i class="fas fa-calculator calculate-peripheral-motes cursor-pointer" title="Auto Set Motes"></i></label>
            <div class="resource-content flexrow flex-center flex-between">
              <input type="number" name="data.motes.peripheral.value" value="{{data.data.motes.peripheral.value}}"
                data-dtype="Number" />
              /
              <input type="number" name="data.motes.peripheral.max" value="{{data.data.motes.peripheral.max}}"
                data-dtype="Number" />
            </div>
          </div>
        </div>
        <div class="resource-content flexrow flex-center flex-between">
          <div>
            <i id="anima-down" class="fas fa-caret-down cursor-pointer"></i><label class="resource-label">{{localize
              "Ex3.Anima"}}</label><i id="anima-up" class="fas fa-caret-up cursor-pointer"></i>
            <div>{{data.data.anima.level}}</div>
          </div>
        </div>
        <div class="resource-content flexrow flex-center flex-between">
          {{#ifEquals data.data.details.exalt 'lunar'}}
          <div>
            <label class="resource-label">{{localize "Ex3.Tell"}}</label>
            <input type="text" name="data.details.tell" value="{{data.data.details.tell}}" />
          </div>
          {{/ifEquals}}
          {{#ifEquals data.data.details.exalt 'dragonblooded'}}
          <div>
            <div class="resource-label">{{localize "Ex3.Aura"}}</div>
            <select name="data.details.aura" data-type="String">
                {{#select data.data.details.aura}}
                <option value="none">{{localize "Ex3.None"}}</option>
                <option value="air">{{localize "Ex3.Air"}}</option>
                <option value="earth">{{localize "Ex3.Earth"}}</option>
                <option value="fire">{{localize "Ex3.Fire"}}</option>
                <option value="water">{{localize "Ex3.Water"}}</option>
                <option value="wood">{{localize "Ex3.Wood"}}</option>
                {{/select}}
            </select>
          </div>
          {{/ifEquals}}
        </div>
      </div>
      <div class="resources grid grid-2col">
        <div class="resource flex-group-center d-flex">
          <div style="margin-right:20px;">
            <div class="flexrow">
              <label for="data.health" class="resource-label"><i class="fas fa-calculator cursor-pointer"
                  id="calculate-health" style="margin-right:3px;" title="Calculate Health"></i>{{localize
                "Ex3.Health"}}<i id="recoveryScene" title="Heal Damage" class="fas fa-plus-square cursor-pointer"
                  style="margin-left:3px;"></i></label>
            </div>
            <div class="resource-content flexrow flex-center flex-between">
              <div class="resource-counter" data-states="/:bashing,x:lethal,*:aggravated"
                data-max="{{data.data.health.total}}" data-bashing="{{data.data.health.bashing}}"
                data-lethal="{{data.data.health.lethal}}" data-aggravated="{{data.data.health.aggravated}}"
                data-name="data.health">
                {{#numLoop data.data.health.total}}
                <span class="resource-counter-step" data-index="{{this}}" data-state=""></span>
                {{/numLoop}}
              </div>
            </div>
          </div>
          <div>
            <div class="flex-center">
              <div class="resource-label">{{localize "Ex3.WoundPenalty"}}</div>
              <div>-{{data.data.health.penalty}}</div>
            </div>
          </div>
        </div>
        <div class="resource-content flexrow flex-center flex-between">
          <div>
            <label class="resource-label">{{localize "Ex3.Willpower"}}</label>
            <div class="resource-content flexrow flex-center flex-between">
              <input type="number" name="data.willpower.value" value="{{data.data.willpower.value}}"
                data-dtype="Number" />/
              <input type="number" name="data.willpower.total" value="{{data.data.willpower.total}}"
                data-dtype="Number" />
            </div>
          </div>
          <div>
            <label class="resource-label">{{localize "Ex3.Limit"}}</label>
            <input type="number" name="data.limit.value" value="{{data.data.limit.value}}" data-dtype="Number" />
          </div>
        </div>
      </div>
    </div>
  </header>

  {{!-- Sheet Tab Navigation --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="stats">{{localize "Ex3.Stats"}}</a>
    <a class="item" data-tab="combat">{{localize "Ex3.Combat"}}</a>
    <a class="item" data-tab="social">{{localize "Ex3.Social"}}</a>
    <a class="item" data-tab="charms">{{localize "Ex3.Charms"}}/{{localize "Ex3.Spells"}}</a>
    <a class="item" data-tab="effects">{{localize "Ex3.Effects"}}</a>
    <a class="item" data-tab="character">{{localize "Ex3.Character"}}</a>
    <a class="item" data-tab="description">{{localize "Ex3.Description"}}</a>
  </nav>

  {{!-- Sheet Body --}}
  <section class="sheet-body">

    <!-- Code for attribute and ability dots taken from foundry-V5

    MIT License

    Copyright (c) 2020 Ray Ji

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE. -->

    {{!-- Stats Tab --}}
    <div class="tab flex-center" data-group="primary" data-tab="stats">
      <div style="padding-top:10px;">
        <label class="resource-label">{{localize "Ex3.Attributes"}}</label>
      </div>
      <div class="attributes grid grid-3col flex-group-center">
        {{#each data.data.attributes as |attribute key|}}
        <div class="attribute flexrow flex-center">
          <input class="attribute-checkbox" name="data.attributes.{{key}}.favored" type="checkbox" {{checked
            attribute.favored}}>
          <label for="data.attributes.{{key}}.value" class="resource-label resource-value"
            data-roll="{{attribute.value}}" data-label="{{attribute.name}}">{{localize attribute.name}}</label>
          <div class="resource-value" data-value="{{attribute.value}}" data-name="data.attributes.{{key}}.value">
            {{#numLoop 5}}
            <span class="resource-value-step" data-index="{{this}}"></span>
            {{/numLoop}}
          </div>
        </div>
        {{/each}}
      </div>
      <label class="resource-label">{{localize "Ex3.Abilities"}}<i id="rollAbility"
          class="fas fa-dice cursor-pointer rollAbility" style="margin-left:5px;"></i></label>
      <div class="attributes grid grid-3col flex-group-center">
        {{#each data.data.abilities as |ability key|}}
        <div class="ability flexrow flex-center">
          <input class="ability-checkbox" name="data.abilities.{{key}}.favored" type="checkbox" {{checked
            ability.favored}}>
          <label for="data.abilities.{{key}}.value" class="resource-label vrollable roll-ability"
            data-roll="{{ability.value}}" data-ability="{{key}}" data-label="{{ability.name}}">{{localize
            ability.name}}</label>
          <div class="resource-value" data-value="{{ability.value}}" data-name="data.abilities.{{key}}.value">
            {{#numLoop 5}}
            <span class="resource-value-step" data-index="{{this}}"></span>
            {{/numLoop}}
          </div>
        </div>
        {{/each}}
      </div>
      <label class="resource-label">{{localize "Ex3.Specialties"}}<a class="item-create" title="Create specialty"
          data-type="specialty"><i class="fas fa-plus cursor-pointer" style="margin-left:5px;"></i></a></label>
      <div class="attributes grid grid-3col flex-group-center">
        {{#each actor.specialties as |item id|}}
        <div class="item flexrow flex-center" data-item-id="{{item._id}}">
          <div class="item-controls ability-item-edit">
            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i> </a>
            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
          </div>
          <label class="resource-label">{{localize item.name}} ({{item.data.ability}})</label>
        </div>
        {{/each}}
      </div>
      <label class="resource-label">{{localize "Ex3.MartialArts"}}<a class="item-create" title="Create martialart"
          data-type="martialart"><i class="fas fa-plus cursor-pointer" style="margin-left:5px;"></i></a></label>
      <div class="attributes grid grid-3col flex-group-center">
        {{#each actor.martialarts as |item id|}}
        <div class="item flexrow flex-center" data-item-id="{{item._id}}">
          <div class="item-controls ability-item-edit">
            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i> </a>
            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
          </div>
          <label class="resource-label">{{localize item.name}}</label>
          <div class="resource-value-static" data-value="{{item.data.points}}" data-name="items.{{item._id}}">
            {{#numLoop 5}}
            <span class="resource-value-static-step" data-index="{{this}}"></span>
            {{/numLoop}}
          </div>
        </div>
        {{/each}}
      </div>
      <label class="resource-label">{{localize "Ex3.Craft"}}<a class="item-create" title="Create craft"
          data-type="craft"><i class="fas fa-plus cursor-pointer" style="margin-left:5px;"></i></a></label>
      <div class="attributes grid grid-3col flex-group-center">
        {{#each actor.crafts as |item id|}}
        <div class="item flexrow flex-center" data-item-id="{{item._id}}">
          <div class="item-controls ability-item-edit">
            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i> </a>
            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
          </div>
          <label class="resource-label">{{localize item.name}}</label>
          <div class="resource-value-static" data-value="{{item.data.points}}" data-name="items.{{item._id}}">
            {{#numLoop 5}}
            <span class="resource-value-static-step" data-index="{{this}}"></span>
            {{/numLoop}}
          </div>
        </div>
        {{/each}}
      </div>
    </div>

    {{!-- Combat Tab --}}
    <div class="tab flex-center" data-group="primary" data-tab="combat">
      {{> systems/exaltedthird/templates/actor/combat-tab.html}}
    </div>


    {{!-- Charms Tab --}}
    <div class="tab items" data-group="primary" data-tab="charms">
      <ol class="items-list">
        <li>
          <div class="resource-label list-section-header mb-2">
            {{localize "Ex3.Anima"}}
          </div>
        </li>
        <li>
          <textarea type="text" name="data.anima.passive" rows="4">{{data.data.anima.passive}}</textarea>
        </li>
        <li>
          <textarea type="text" name="data.anima.active" rows="4">{{data.data.anima.active}}</textarea>
        </li>
        <li>
          <textarea type="text" name="data.anima.iconic" rows="4">{{data.data.anima.iconic}}</textarea>
        </li>
        {{> systems/exaltedthird/templates/actor/charm-list.html}}
      </ol>
    </div>

    <div class="tab effects" data-group="primary" data-tab="effects">
      {{> systems/exaltedthird/templates/actor/active-effects.html}}
    </div>

    {{!-- Intimacy Tab --}}
    <div class="tab social" data-group="primary" data-tab="social">
      {{> systems/exaltedthird/templates/actor/social-tab.html}}
    </div>

    {{!-- Character Tab --}}
    <div class="tab character" data-group="primary" data-tab="character">
      <ol class="items-list">
        <div class="grid grid-2col flex-group-center">
          <div class="resource-content flexrow flex-center flex-between">
            <div>
              <label class="resource-label">{{localize "Ex3.Personal"}} XP ({{data.data.experience.standard.spent}} Spent)</label>
              <div class="resource-content flexrow flex-center flex-between">
                <input name="data.experience.standard.value" value="{{data.data.experience.standard.value}}" type="text"
                  placeholder="Remaining" />
                /
                <input name="data.experience.standard.total" value="{{data.data.experience.standard.total}}" type="text"
                  placeholder="Earned" />
              </div>
            </div>
          </div>
          <div class="resource-content flexrow flex-center flex-between">
            <div>
              <label class="resource-label">{{localize "Ex3.Exalt"}} XP ({{data.data.experience.exalt.spent}} Spent)</label>
              <div class="resource-content flexrow flex-center flex-between">
                <input name="data.experience.exalt.value" value="{{data.data.experience.exalt.value}}" type="text"
                  placeholder="Remaining" />
                /
                <input name="data.experience.exalt.total" value="{{data.data.experience.exalt.total}}" type="text"
                  placeholder="Earned" />
              </div>
            </div>
          </div>
        </div>
        <div class="flex-center">
          <label class="resource-label">{{localize "Ex3.Craft"}} <i class="fas fa-info-circle show-craft cursor-pointer"></i></label>
          <div class="grid grid-4col flex-group-center">
            <div>
              <button class="roll-button craft-project" data-type="basic"><i class="fas fa-hammer"></i>{{localize "Ex3.Basic"}}</button>
            </div>
            <div>
              <button class="roll-button craft-project" data-type="major"><i class="fas fa-hammer"></i>{{localize "Ex3.Major"}}</button>
            </div>
            <div>
              <button class="roll-button craft-project" data-type="superior"><i class="fas fa-hammer"></i>{{localize "Ex3.Superior"}}</button>
            </div>
            <div>
              <button class="roll-button craft-project" data-type="legendary"><i class="fas fa-hammer"></i>{{localize "Ex3.Legendary"}}</button>
            </div>
          </div>
          <div class="grid grid-3col flex-group-center">
            <div>
              <label class="resource-label">{{localize "Ex3.SilverXP"}}</label>
              <input type="number" name="data.craft.experience.silver.value"
                value="{{data.data.craft.experience.silver.value}}" data-dtype="Number" />
            </div>
            <div>
              <label class="resource-label">{{localize "Ex3.GoldXP"}}</label>
              <input type="number" name="data.craft.experience.gold.value"
                value="{{data.data.craft.experience.gold.value}}" data-dtype="Number" />
            </div>
            <div>
              <label class="resource-label">{{localize "Ex3.WhiteXP"}}</label>
              <input type="number" name="data.craft.experience.white.value"
                value="{{data.data.craft.experience.white.value}}" data-dtype="Number" />
            </div>
            <div>
              <label class="resource-label">{{localize "Ex3.Major"}}</label>
              <div class="resource-content flexrow flex-center flex-between">
                <input name="data.craft.slots.major.value" value="{{data.data.craft.slots.major.value}}" type="text"
                  placeholder="Available" />
                /
                <input name="data.craft.slots.major.total" value="{{data.data.craft.slots.major.total}}" type="text"
                  placeholder="Total" />
              </div>
            </div>
            <div>
              <label class="resource-label">{{localize "Ex3.Superior"}}</label>
              <div class="resource-content flexrow flex-center flex-between">
                <input name="data.craft.slots.superior.value" value="{{data.data.craft.slots.superior.value}}" type="text"
                  placeholder="Available" />
                /
                <input name="data.craft.slots.superior.total" value="{{data.data.craft.slots.superior.total}}" type="text"
                  placeholder="Total" />
              </div>
            </div>
            <div>
              <label class="resource-label">{{localize "Ex3.Legendary"}}</label>
              <div class="resource-content flexrow flex-center flex-between">
                <input name="data.craft.slots.legendary.value" value="{{data.data.craft.slots.legendary.value}}" type="text"
                  placeholder="Available" />
                /
                <input name="data.craft.slots.legendary.total" value="{{data.data.craft.slots.legendary.total}}" type="text"
                  placeholder="Total" />
              </div>
            </div>
          </div>
        </div>
        <div class="resource-label list-section-header d-flex flex-between">
          <div>
            {{localize "Ex3.CraftProjects"}}
          </div>
          <a class="item-control item-create" title="Create craftproject" data-type="craftproject"><i
              class="fas fa-plus"></i>Add project</a>
        </div>
        {{#each actor.projects as |item id|}}
        <li class="item flexrow item-row" data-item-id="{{item._id}}">
          <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24" /></div>
          <h4 class="item-name">{{item.name}}</h4>
          <div class="item-controls">
            <a class="item-control item-complete" title="Complete Item"><i class="fas fa-hammer"></i></a>
            <a class="item-control item-chat" title="Chat Item"><i class="fas fa-comment"></i></a>
            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
          </div>
        </li>
        <li>
          <div>
            {{{item.data.description}}}
          </div>
        </li>
        {{/each}}
        <li>
          <label class="resource-label">{{localize "Ex3.Resonance"}}</label>
          <input type="text" name="data.advantages.resonance" value="{{data.data.advantages.resonance}}" />
        </li>
        <div>
          <div class="check-button">
              <label class="resource-label">{{localize "Ex3.LegendarySize"}}:</label>
              <input data-dtype="Boolean" name="data.legendarysize" type="checkbox" {{checked data.data.legendarysize}}>
          </div>
        </div>
        <div class="mt-1">
          <label class="resource-label">{{localize "Ex3.Languages"}}</label>
          <a class="trait-selector" data-options="languages" data-target="data.traits.languages">
            <i class="fas fa-edit"></i>
          </a>
          <div class="mt-1">
            {{#each data.data.traits.languages.selected as |v k|}}
            <li class="tag {{k}}">{{v}}</li>
            {{/each}}
          </div>
        </div>
        <div class="resource-label list-section-header d-flex flex-between">
          <div>
            {{localize "Ex3.Initiations"}}
          </div>
          <a class="item-control item-create" title="Create initiation" data-type="initiation"><i
              class="fas fa-plus"></i>Add Initiation</a>
        </div>
        {{#each actor.initiations as |item id|}}
        <li class="item flexrow item-row" data-item-id="{{item._id}}">
          <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24" /></div>
          <h4 class="item-name">{{item.name}}</h4>
          <div class="item-controls">
            <a class="item-control item-chat" title="Chat Item"><i class="fas fa-comment"></i></a>
            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
          </div>
        </li>
        <li>
          <div>
            {{{item.data.description}}}
          </div>
        </li>
        {{/each}}
        <div class="resource-label list-section-header d-flex flex-between">
          <div>
            {{localize "Ex3.Merits"}}
          </div>
          <a class="item-control item-create" title="Create merit" data-type="merit"><i class="fas fa-plus"></i>Add
            Merit</a>
        </div>
        {{#each actor.merits as |item id|}}
        <li class="item flexrow item-row" data-item-id="{{item._id}}">
          <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24" /></div>
          <h4 class="item-name">{{item.name}}</h4>
          <div class="resource-value-static" data-value="{{item.data.points}}" data-name="items.{{item._id}}">
            {{#numLoop 5}}
            <span class="resource-value-static-step" data-index="{{this}}"></span>
            {{/numLoop}}
          </div>
          <div class="item-controls">
            <a class="item-control item-chat" title="Chat Item"><i class="fas fa-comment"></i></a>
            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
          </div>
        </li>
        <li>
          <div>
            {{{item.data.description}}}
          </div>
        </li>
        {{/each}}
      </ol>
    </div>

    {{!-- Biography Tab --}}
    <div class="tab biography" data-group="primary" data-tab="description">
      {{editor content=data.data.biography target="data.biography" button=true owner=owner editable=true}}
    </div>

  </section>
</form>